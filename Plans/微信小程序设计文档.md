# 餐食关系系统微信小程序设计文档

## 1. 系统概述

### 1.1 设计目标
- **便捷访问**：通过微信小程序提供便捷的系统访问方式
- **功能完整**：实现核心业务功能，满足用户需求
- **用户体验**：提供流畅、直观的用户体验
- **性能优化**：确保小程序加载速度快，运行流畅
- **安全可靠**：保障用户数据和支付安全

### 1.2 核心功能
- **客户端**：餐单查询、在线预约、服务评价、个人中心
- **管理端**：工作台、客户管理、排餐管理、员工考勤、数据统计

### 1.3 技术架构
- **前端**：WXML、WXSS、JavaScript、微信小程序原生框架
- **后端**：Flask RESTful API
- **数据存储**：微信小程序本地存储、云存储
- **支付集成**：微信支付API

## 2. 客户端设计

### 2.1 整体结构

#### 2.1.1 页面结构
- **首页**：功能入口、今日餐单预览、通知公告
- **餐单**：每日餐单、历史餐单、餐食评价
- **预约**：服务预约、预约记录、预约状态
- **个人中心**：个人信息、消费记录、服务评价、设置

#### 2.1.2 导航设计
- **底部导航栏**：固定在底部，包含4个主要入口
- **顶部导航栏**：显示页面标题、返回按钮
- **页面内导航**：通过卡片、列表等方式导航到子页面

#### 2.1.3 响应式设计
- **适配**：支持不同尺寸的手机屏幕
- **布局**：使用Flexbox和Grid布局，确保界面美观
- **字体**：根据屏幕尺寸自动调整字体大小

### 2.2 核心页面设计

#### 2.2.1 首页

##### 2.2.1.1 布局
- **顶部**：欢迎信息、用户头像
- **中部**：今日餐单预览（卡片式）
- **功能区**：快捷功能入口（预约服务、查看餐单、评价服务）
- **通知区**：最新通知和公告
- **底部**：底部导航栏

##### 2.2.1.2 交互
- **点击餐单**：进入今日餐单详情
- **点击功能入口**：进入对应功能页面
- **下拉刷新**：刷新页面内容
- **滑动切换**：滑动查看更多通知

##### 2.2.1.3 设计风格
- **色彩**：浅粉色（#FFB6C1）为主色调，温暖、柔和
- **图标**：线性图标，简洁美观
- **布局**：卡片式设计，层次分明

#### 2.2.2 餐单页面

##### 2.2.2.1 布局
- **顶部**：日期选择器、餐型切换（早餐/午餐/晚餐）
- **中部**：餐单列表（包含菜品图片、名称、描述）
- **底部**：评价入口、底部导航栏

##### 2.2.2.2 交互
- **日期选择**：点击选择日期，查看对应日期的餐单
- **餐型切换**：点击切换餐型，显示对应餐型的菜品
- **点击菜品**：查看菜品详情，包括营养成分、食材组成
- **评价按钮**：点击进入评价页面，对餐食进行评价
- **滑动加载**：滑动加载更多日期的餐单

##### 2.2.2.3 设计风格
- **色彩**：浅粉色为主色调，搭配白色和浅灰色
- **卡片**：菜品卡片使用圆角设计，带有轻微阴影
- **图片**：菜品图片使用正方形，展示清晰

#### 2.2.3 预约页面

##### 2.2.3.1 布局
- **顶部**：预约类型选择
- **中部**：预约表单（日期、时间、人数、特殊需求）
- **底部**：提交按钮、预约记录入口、底部导航栏

##### 2.2.3.2 交互
- **类型选择**：点击选择预约类型（陪护、护理、其他服务）
- **日期选择**：点击选择预约日期，显示可预约时间
- **时间选择**：点击选择预约时间
- **表单提交**：填写完整后提交预约申请
- **预约记录**：点击查看历史预约记录和状态

##### 2.2.3.3 设计风格
- **色彩**：浅粉色为主色调，强调色使用橙色
- **表单**：表单项使用下划线风格，简洁明了
- **按钮**：提交按钮使用主色调，突出显示

#### 2.2.4 个人中心页面

##### 2.2.4.1 布局
- **顶部**：用户头像、姓名、会员等级
- **功能区**：个人信息、消费记录、服务评价、我的预约、设置
- **底部**：客服入口、关于我们、退出登录、底部导航栏

##### 2.2.4.2 交互
- **点击头像**：修改头像
- **个人信息**：点击进入个人信息编辑页面
- **消费记录**：点击查看详细的消费记录
- **服务评价**：点击查看历史评价记录
- **我的预约**：点击查看预约记录和状态
- **设置**：点击进入设置页面，进行账号、通知等设置
- **退出登录**：点击退出当前账号

##### 2.2.4.3 设计风格
- **色彩**：浅粉色为主色调，背景使用白色
- **列表**：功能列表使用左图标右箭头的样式
- **头像**：圆形头像，带有边框

### 2.3 核心功能实现

#### 2.3.1 餐单查询
- **API接口**：`/api/wechat/customer/menu`
- **数据缓存**：缓存最近7天的餐单数据
- **离线访问**：支持离线查看已缓存的餐单
- **实时更新**：下拉刷新获取最新餐单

#### 2.3.2 在线预约
- **API接口**：`/api/wechat/customer/appointment`
- **预约流程**：选择服务类型 → 选择日期时间 → 填写需求 → 提交预约 → 支付定金
- **状态管理**：待确认、已确认、已完成、已取消
- **通知提醒**：预约状态变更时发送微信通知

#### 2.3.3 服务评价
- **API接口**：`/api/wechat/customer/feedback`
- **评价内容**：星级评分、文字评价、图片评价
- **评价范围**：餐食评价、服务评价
- **评价管理**：查看历史评价，修改未回复的评价

#### 2.3.4 个人信息管理
- **API接口**：`/api/wechat/customer/profile`
- **信息编辑**：修改姓名、联系方式、饮食禁忌等
- **信息同步**：与系统后端同步个人信息
- **隐私设置**：控制个人信息的可见性

### 2.4 支付功能

#### 2.4.1 微信支付集成
- **API接口**：`/api/payment/orders`
- **支付流程**：选择服务 → 确认订单 → 发起支付 → 完成支付 → 订单更新
- **支付方式**：微信支付（小程序支付）
- **支付安全**：使用微信支付API，确保支付安全

#### 2.4.2 支付场景
- **预约定金**：预约服务时支付定金
- **餐费支付**：结算餐费时进行支付
- **服务费支付**：支付陪护、护理等服务费

#### 2.4.3 支付记录
- **查询接口**：`/api/wechat/customer/payments`
- **记录内容**：支付时间、金额、订单号、支付状态
- **筛选功能**：按时间、类型筛选支付记录
- **导出功能**：支持导出支付记录

## 3. 管理端设计

### 3.1 整体结构

#### 3.1.1 页面结构
- **工作台**：待办事项、客户概览、员工考勤
- **客户管理**：客户列表、客户详情、服务安排
- **排餐管理**：排餐日历、餐单编辑、禁忌检查
- **统计分析**：财务概览、员工工作量、客户满意度

#### 3.1.2 导航设计
- **底部导航栏**：固定在底部，包含4个主要入口
- **顶部导航栏**：显示页面标题、返回按钮、快捷操作
- **侧边菜单**：通过左上角按钮打开，包含更多管理功能

#### 3.1.3 权限管理
- **角色区分**：根据登录用户的角色显示不同的功能
- **权限控制**：某些功能需要特定权限才能访问
- **操作记录**：记录管理员的操作日志

### 3.2 核心页面设计

#### 3.2.1 工作台

##### 3.2.1.1 布局
- **顶部**：欢迎信息、今日日期
- **数据概览**：今日客户数、今日订单数、待处理任务数
- **待办事项**：需要处理的任务列表
- **最近通知**：系统通知、客户预约提醒
- **快捷操作**：员工打卡、快速排餐

##### 3.2.1.2 交互
- **点击待办事项**：进入对应处理页面
- **点击快捷操作**：执行对应操作
- **下拉刷新**：刷新工作台数据
- **滑动查看**：滑动查看更多通知

##### 3.2.1.3 设计风格
- **色彩**：浅蓝色（#B3E5FC）为主色调，专业、冷静
- **卡片**：数据概览使用卡片式设计，突出显示
- **图标**：使用线性图标，保持一致性

#### 3.2.2 客户管理

##### 3.2.2.1 布局
- **顶部**：搜索框、筛选按钮
- **中部**：客户列表（包含客户姓名、入住状态、联系方式）
- **底部**：添加客户按钮、底部导航栏

##### 3.2.2.2 交互
- **搜索客户**：输入客户姓名或联系方式进行搜索
- **筛选客户**：按入住状态、入住时间等筛选客户
- **点击客户**：进入客户详情页面
- **添加客户**：点击添加新客户
- **滑动操作**：滑动客户列表项，显示快捷操作（编辑、删除）

##### 3.2.2.3 设计风格
- **色彩**：浅蓝色为主色调，背景使用白色
- **列表**：客户列表使用卡片式设计，带有轻微阴影
- **状态**：使用不同颜色的标签显示客户状态

#### 3.2.3 排餐管理

##### 3.2.3.1 布局
- **顶部**：日期选择器、排餐类型（早餐/午餐/晚餐）
- **中部**：排餐日历、餐单编辑区域
- **底部**：自动排餐按钮、保存按钮、底部导航栏

##### 3.2.3.2 交互
- **日期选择**：点击选择排餐日期
- **排餐类型**：点击切换排餐类型
- **自动排餐**：点击自动生成餐单
- **手动调整**：点击菜品进行添加、删除、修改
- **禁忌检查**：排餐时自动检查客户禁忌食材
- **保存餐单**：点击保存排餐结果

##### 3.2.3.3 设计风格
- **色彩**：浅蓝色为主色调，强调色使用绿色
- **日历**：月历视图，当前日期突出显示
- **餐单**：餐单编辑区域使用拖拽式设计
- **禁忌**：禁忌食材使用红色标记，突出显示

#### 3.2.4 统计分析

##### 3.2.4.1 布局
- **顶部**：统计周期选择（日/周/月/年）
- **中部**：数据图表（收支趋势、客户满意度、员工工作量）
- **底部**：数据表格、导出按钮、底部导航栏

##### 3.2.4.2 交互
- **周期选择**：点击选择统计周期
- **图表交互**：点击图表查看详细数据
- **数据筛选**：按部门、员工、客户等筛选数据
- **导出数据**：点击导出统计数据为Excel格式
- **刷新数据**：下拉刷新获取最新统计数据

##### 3.2.4.3 设计风格
- **色彩**：浅蓝色为主色调，图表使用不同颜色区分数据
- **图表**：使用柱状图、折线图、饼图等多种图表类型
- **布局**：数据卡片式布局，清晰展示各项数据

### 3.3 核心功能实现

#### 3.3.1 员工考勤
- **API接口**：`/api/wechat/admin/attendance`
- **打卡功能**：支持上班打卡、下班打卡
- **打卡记录**：查看历史打卡记录
- **异常处理**：处理迟到、早退、缺勤等异常情况
- **考勤统计**：统计月度考勤情况

#### 3.3.2 客户管理
- **API接口**：`/api/wechat/admin/customers`
- **客户信息**：查看、编辑客户基本信息
- **服务安排**：为客户安排陪护、护理等服务
- **状态管理**：更新客户的入住、退房状态
- **特殊需求**：记录客户的特殊需求和禁忌

#### 3.3.3 排餐管理
- **API接口**：`/api/wechat/admin/menus`
- **自动排餐**：根据客户禁忌自动生成餐单
- **手动调整**：支持手动调整餐单
- **餐单发布**：发布餐单，通知客户
- **历史餐单**：查看历史餐单记录

#### 3.3.4 数据统计
- **API接口**：`/api/wechat/admin/statistics`
- **财务统计**：收支明细、利润分析
- **员工统计**：工作量统计、薪资计算
- **客户统计**：客户满意度、复购率
- **趋势分析**：数据变化趋势分析

### 3.4 批量操作

#### 3.4.1 批量消息
- **功能**：向多个客户发送通知消息
- **模板**：使用预设的消息模板
- **发送方式**：微信消息、短信
- **发送记录**：查看历史发送记录

#### 3.4.2 批量排餐
- **功能**：为多个客户批量排餐
- **规则**：根据客户的禁忌和偏好批量生成餐单
- **预览**：排餐前预览餐单效果
- **调整**：支持批量调整餐单

## 4. 通用设计

### 4.1 视觉设计

#### 4.1.1 色彩方案
- **客户端**：浅粉色（#FFB6C1）为主色调，温暖、柔和
- **管理端**：浅蓝色（#B3E5FC）为主色调，专业、冷静
- **通用色**：
  - 成功：#4CAF50（绿色）
  - 警告：#FFC107（黄色）
  - 错误：#F44336（红色）
  - 信息：#2196F3（蓝色）

#### 4.1.2 字体设计
- **主字体**：微信默认字体
- **标题字体**：16-18px，粗体
- **正文字体**：14px，常规
- **小字体**：12px，常规
- **字体颜色**：
  - 主文字：#333333
  - 次要文字：#757575
  - 提示文字：#9E9E9E

#### 4.1.3 图标设计
- **图标库**：使用微信官方图标库或Font Awesome
- **风格**：线性图标，保持一致性
- **大小**：16px（正文）、24px（标题）、32px（导航）
- **颜色**：根据使用场景选择合适的颜色

#### 4.1.4 布局设计
- **卡片**：使用卡片式设计，带有轻微阴影
- **间距**：统一使用8px、16px、24px的间距
- **圆角**：按钮、卡片使用4px-8px的圆角
- **对齐**：保持元素对齐，确保界面整洁

### 4.2 交互设计

#### 4.2.1 通用交互
- **触摸反馈**：按钮、卡片等可点击元素有触摸反馈
- **加载状态**：操作过程中显示加载动画
- **错误提示**：操作失败时显示友好的错误提示
- **成功提示**：操作成功时显示成功提示
- **确认操作**：重要操作需要用户确认

#### 4.2.2 页面跳转
- **导航跳转**：使用wx.navigateTo进行页面跳转
- **返回**：使用wx.navigateBack返回上一页
- **切换**：使用wx.switchTab切换底部导航栏
- **重定向**：使用wx.redirectTo重定向页面

#### 4.2.3 数据交互
- **下拉刷新**：支持下拉刷新获取最新数据
- **上拉加载**：支持上拉加载更多数据
- **实时更新**：重要数据实时更新
- **数据缓存**：缓存常用数据，提高加载速度

### 4.3 性能优化

#### 4.3.1 加载优化
- **小程序启动**：优化小程序启动速度
- **页面加载**：减少页面加载时间
- **资源加载**：压缩图片、代码，减少资源大小
- **预加载**：预加载可能需要的页面和数据

#### 4.3.2 运行优化
- **内存管理**：合理管理内存使用
- **代码优化**：减少不必要的计算和渲染
- **事件处理**：优化事件处理，避免卡顿
- **网络请求**：减少网络请求次数，使用缓存

#### 4.3.3 存储优化
- **本地存储**：合理使用本地存储，避免存储过多数据
- **云存储**：使用云存储存储大文件
- **数据清理**：定期清理无用数据

### 4.4 安全设计

#### 4.4.1 登录安全
- **微信登录**：使用微信官方的登录方式
- **会话管理**：合理管理登录会话
- **密码保护**：重要操作需要验证

#### 4.4.2 数据安全
- **数据传输**：使用HTTPS加密传输数据
- **数据存储**：敏感数据加密存储
- **权限控制**：根据用户权限控制数据访问

#### 4.4.3 支付安全
- **微信支付**：使用微信官方的支付接口
- **交易验证**：验证支付交易的真实性
- **订单安全**：防止订单篡改

## 5. 开发与部署

### 5.1 开发流程

#### 5.1.1 开发环境
- **微信开发者工具**：用于小程序开发和调试
- **后端开发环境**：Flask + Python
- **版本控制**：Git

#### 5.1.2 开发规范
- **代码规范**：遵循JavaScript和Python的代码规范
- **命名规范**：统一的变量、函数、文件命名规范
- **注释规范**：添加必要的注释，提高代码可读性
- **目录结构**：清晰的目录结构，便于管理

#### 5.1.3 测试流程
- **本地测试**：在微信开发者工具中进行测试
- **真机测试**：在真实设备上进行测试
- **用户测试**：邀请真实用户进行测试
- **性能测试**：测试小程序的性能和稳定性

### 5.2 部署流程

#### 5.2.1 小程序发布
- **代码审核**：提交代码到微信公众平台审核
- **版本管理**：管理小程序的版本
- **灰度发布**：支持灰度发布新功能
- **回滚机制**：支持版本回滚

#### 5.2.2 后端部署
- **服务器部署**：部署Flask API到服务器
- **数据库部署**：部署和配置数据库
- **API文档**：生成和维护API文档
- **监控告警**：监控API的运行状态

#### 5.2.3 运维管理
- **日志管理**：收集和分析系统日志
- **错误监控**：监控和处理系统错误
- **性能监控**：监控系统性能指标
- **安全监控**：监控系统安全状态

## 6. 总结

本微信小程序设计文档详细描述了餐食关系系统的微信小程序设计，包括客户端和管理端的功能、界面和交互设计。设计充分考虑了微信小程序的特点和用户需求，提供了便捷、直观的用户体验。

通过本设计，系统将为用户提供一个功能完整、性能优良、安全可靠的微信小程序，满足客户和管理员的日常使用需求。同时，设计也考虑了未来的功能扩展和性能优化，为系统的可持续发展奠定了基础。

微信小程序作为系统的重要组成部分，将与Web端和后端系统紧密集成，形成一个完整的餐食关系管理系统，为企业的运营管理提供有力的支持。